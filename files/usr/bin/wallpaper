#!/usr/bin/env bash

WALLPAPER_PATH=""
# Default Wallpaper, feel free to change this to whatever you like
DEFAULT_WALLPAPER="$HOME/Pictures/Wallpapers/Mocha/bridge.jpg"

if [ ! -f "$HOME/.config/wallpaper" ]; then
    echo "$DEFAULT_WALLPAPER" > "$HOME/.config/wallpaper"
fi

if [[ $1 == "init" ]]; then
    WALLPAPER_PATH=$(cat "$HOME/.config/wallpaper")
    if [ ! -f "$WALLPAPER_PATH" ]; then
        echo "$DEFAULT_WALLPAPER" > "$HOME/.config/wallpaper"
        WALLPAPER_PATH="$DEFAULT_WALLPAPER"
    fi
else
    if [ ! -f "$1" ]; then
        echo "Error: No File Exists at $1"
        exit 1
    fi
    WALLPAPER_PATH="$1"
fi

PID=$(pidof swaybg)
if [[ "$PID" != "" ]]; then
    kill $PID
fi

FULL_WALLPAPER_PATH="${WALLPAPER_PATH/#\~/$HOME}"
echo "$FULL_WALLPAPER_PATH" > "$HOME/.config/wallpaper"

swaybg -i "$FULL_WALLPAPER_PATH" -m fill &

